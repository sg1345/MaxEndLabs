@model MaxEndLabs.ViewModels.ManageVariantsViewModel


<form asp-action="VariantManager" method="post">
	<div asp-validation-summary="All" class="text-danger mb-3 font-weight-bold"></div>
	<input type="hidden" asp-for="ProductId"/>
	<input type="hidden" asp-for="ProductId"/>
	<input type="hidden" asp-for="ProductName"/>
	<input type="hidden" asp-for="ProductSlug"/>
	<input type="hidden" asp-for="CategorySlug"/>

	<div id="variantContainer">

		@for (int i = 0; i < Model.Variants.Count; i++)
		{
			<div class="row mb-3 variant-row">
				<input type="hidden" name="Variants.Index" value="@i"/>
				<input type="hidden" name="Variants[@i].Id" value="@Model.Variants[i].Id"/>

				<div class="col-md-5">
					<input name="Variants[@i].Name" value="@Model.Variants[i].Name" class="form-control"/>
				</div>
				<div class="col-md-5">
					<input name="Variants[@i].Price" value="@Model.Variants[i].Price" type="number" step="0.01" class="form-control"/>
				</div>
				<div class="col-md-2">
					<button type="button" class="btn btn-outline-danger" onclick="this.closest('.row').remove()">Remove</button>
				</div>
			</div>
		}
	</div>

	<button type="button" class="btn btn-primary" id="addBtn">Add New Variant</button>
	<button type="submit" class="btn btn-success">Save All Changes</button>
</form>

@section Scripts {
		<script>          
	    let index = @Model.Variants.Count;

	    document.getElementById('addBtn').addEventListener('click', function() {
	        const container = document.getElementById('variantContainer');
	        const html = `
	            <div class="row mb-3 variant-row">
	                <input type="hidden" name="Variants.Index" value="${index}" />
	                
	                <input type="hidden" name="Variants[${index}].Id" value="0" />
	                <div class="col-md-5">
	                    <input name="Variants[${index}].Name" class="form-control" placeholder="New Name" />
	                </div>
	                <div class="col-md-5">
	                    <input name="Variants[${index}].Price" type="number" step="0.01" class="form-control" placeholder="New Price" />
	                </div>
	                <div class="col-md-2">
	                    <button type="button" class="btn btn-danger" onclick="this.closest('.row').remove()">Remove</button>
	                </div>
	            </div>`;
	        container.insertAdjacentHTML('beforeend', html);
	        index++;
	    });
	</script>
}